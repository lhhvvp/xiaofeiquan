<!--内容开始-->
<section class="content">
    <!--顶部提示开始-->
    <!--顶部提示结束-->
    <div class="container-fluid">
        <div class="row">
            <!--搜索区域开始-->
            <div class="col-12 search-collapse">
                <form id="search_form" name="search_form">
                    <div class="select-list">
                        <ul>
                            <li>
                                <label>商户名称：</label>
                                <input type="text" name="seller_nickname" value="">
                            </li>
                            <li>
                                <label>姓名：</label>
                                <input type="text"  name="name" value="">
                            </li>
                            <li>
                                <label>电话：</label>
                                <input type="text" name="mobile" value="">
                            </li>
                            <li>
                                <label>状态：</label>
                                <select id="search_status" name="status">
                                    <option value="">所有</option>
                                    {foreach $status_list as $key=>$item}
                                    <option value="{$key}">{$item}</option>
                                    {/foreach}
                                </select>
                            </li>
                            <li>
                                <a class="btn btn-primary btn-rounded btn-sm" onclick="$.table.search()">&nbsp;搜索</a> <a class="btn btn-warning btn-rounded btn-sm" onclick="resetPre()">&nbsp;重置</a> <input class="hide" type="submit" name="btnSave" value="提交" onclick="$.table.search();return false;">
                            </li>
                        </ul>
                    </div>
                </form>
            </div>
            <!--搜索区域结束-->

            <div class="col-sm-12 select-table table-striped">
                <div class="btn-group-sm" id="toolbar" role="group">
                    <a class="btn btn-success" onclick="add();">
                        <i class="fa fa-plus"></i> 添加 </a>
                   <!-- <a class="btn btn-primary single disabled" onclick="edit();">
                        <i class="fa fa-edit"></i> 修改        </a>-->
                    <a class="btn btn-danger multiple disabled"  onclick="$.operate.removeAll()">
                        <i class="fa fa-times"></i> 删除        </a>
                    <!-- <a class="btn btn-warning"  onclick="$.table.export()">
            <i class="fa fa-download"></i> 导出        </a> -->
                </div>
                <table id="bootstrap-table" data-mobile-responsive="true"></table>
            </div>
        </div>
    </div>
    <script>
        $(function() {
            var options = {
                uniqueId      : "id",         // 表格主键名称，（默认为id，如表主键不为id必须设置主键）
                url           : "/admin/MerchantVerifier/index.html?getList=1",      // 请求后台的URL
                addUrl        : "/admin/MerchantVerifier/add.html",       // 新增的地址
                editUrl       : "/admin/MerchantVerifier/edit.html?id=__id__",      // 修改的地址
                delUrl        : "/admin/MerchantVerifier/del.html",       // 删除的地址
                exportUrl     : "/admin/MerchantVerifier/export.html",    // 导出的地址
                sortUrl       : "/admin/MerchantVerifier/sort.html",      // 排序的地址
                sortName      : "id",         // 排序列名称
                sortOrder     : "desc",                 // 排序方式  asc 或者 desc
                pagination    : true,			// 是否进行分页
                parentIdField : "pid",   // 列表树模式需传递父id字段名（parent_id/pid）
                clickToSelect : true,				    // 默认false不响应，设为true则当点击此行的某处时，会自动选中此行的checkbox/radiobox
                pageSize      : "10",         // 每页显示的行数
                layerOpen     : "1",        // 添加/审核等页启用layer弹层加载
                emptyTips     : "没有找到匹配的记录",        // 空数据提示信息
                fixedColumns  : true,                   // 是否启用固定列功能
                fixedLeft     : 0,          // 左侧固定列数
                fixedRight    : 1,         // 右侧固定列数
                columns: [
                    {
                        //field: 'state',
                        checkbox: true,
                        // 当某行包含checkbox_disabled时禁止选择
                        formatter: function(value, row, index) {
                            if(row.checkbox_disabled =='1'){
                                return {
                                    disabled : true
                                }
                            }
                        }
                    },
                    {
                        field: 'id',
                        title: '编号',
                        sortable: true,
                        align:"center",
                        width:80
                    },

                    {
                        field: 'name',
                        title: '姓名'
                    },
                    /*{
                        field: 'image',
                        title: '头像',
                        sortable: false,
                        formatter: function(value, row, index) {
                            if ($.common.isNotEmpty(value)) {
                                return '<a href="' + value + '" target="_blank"><img class="image_preview" src="' + value + '"></a>';
                            }
                        }
                    },*/
                    {
                        field: 'mobile',
                        title: '电话',
                        sortable: false,
                        formatter: function(value, row, index) {
                            return HTMLDecode(value);
                        }
                    },
                    {
                        field: 'account',
                        title: '登陆账号',
                        sortable: false,
                        align:"center",
                        formatter: function(value, row, index) {
                            return value?value:'未设置';
                        }
                    },
                    {
                        field: 'seller.nickname',
                        title: '商户名称',
                        sortable: false,
                        align:'center',

                    },
                    {
                        field: 'create_time',
                        title: '创建时间',
                        sortable: false,
                        formatter: function(value, row, index) {
                            return changeDateFormat(value);
                        }
                    },
                    {
                        field: 'update_time',
                        title: '更新时间',
                        sortable: false,
                        formatter: function(value, row, index) {
                            return changeDateFormat(value);
                        }
                    },
                   /* {
                        field: 'status',
                        title: '启用禁用',
                        sortable: false,
                        formatter: function(value, row, index) {
                            if (value == 0) {
                                return '<i class="fa fa-toggle-off text-info fa-2x cursor_pointer" onclick="$.operate.state(\'' + row.id + '\',\'/admin/MerchantVerifier/state.html\')"></i>';
                            } else if(value ==1) {
                                return '<i class="fa fa-toggle-on text-info fa-2x cursor_pointer" onclick="$.operate.state(\'' + row.id + '\',\'/admin/MerchantVerifier/state.html\')"></i>';
                            }else{
                                return row.status_text;
                            }
                        }
                    },*/
                    {
                        field: 'status_text',
                        title: '状态',
                        sortable: false,
                        align:"center"
                    },
                    {
                        field: 'right_button',
                        title: '操作',
                        sortable: false,
                        class : 'text-nowrap',
                        formatter: function(value, row, index) {
                            var actions = [];
                            actions.push('<a class="btn btn-primary btn-xs" target="" href="javascript:void(0)" onclick="see(\'/admin/MerchantVerifier/see.html?_layer=1&id='+row.id+'\')">查看</a> ');
                            actions.push('<a class="btn btn-primary btn-xs" href="javascript:void(0)" onclick="edit(\'' + row.id + '\')"><i class="fa fa-edit"></i> 修改</a> ');
                            actions.push('<a class="btn btn-info btn-xs" href="javascript:void(0)" onclick="editPassword(\'' + row.id + '\')">密</a> ');
                            actions.push('<a class="btn btn-warning btn-xs" href="javascript:void(0)" onclick="check(\'' + row.id + '\')"><i class="fa fa-edit"></i> 审核</a> ');
                            actions.push('<a class="btn btn-danger btn-xs confirm" href="javascript:void(0)" onclick="$.operate.remove(\'' + row.id + '\')"><i class="far fa-trash-alt"></i> 删除</a> ');
                            return actions.join('');
                        }
                    },
                ]
            };
            $.table.init(options);
        });

        // 搜索
        function searchPre() {
            var data = {};
            $.table.search('', data);
        }

        // 重置搜索
        function resetPre() {
            $.form.reset();
        }
        //HTML反转义
        function HTMLDecode(text) {
            var temp = document.createElement("div");
            temp.innerHTML = text;
            var output = temp.innerText || temp.textContent;
            temp = null;
            return output;
        }

        // 添加商户
        function add(id) {
            var url = $.operate.addUrl(id)
            if ($.table._option.layerOpen == "1") {
                // 通过参数隐藏左侧和顶部等数据
                if (url.indexOf('?') != -1) {
                    url = url + '&_layer=1'
                } else {
                    url = url + '?_layer=1'
                }
                // 弹窗打开要添加的地址
                $.modal.open("添加", url);
            } else {
                // 当前窗口打开要添加的地址
                $.common.jump(url);
            }
        }

        // 修改商户
        function edit(id) {
            var url = $.operate.editUrl(id)
            if ($.table._option.layerOpen == "1") {
                // 通过参数隐藏左侧和顶部等数据
                if (url.indexOf('?') != -1) {
                    url = url + '&_layer=1'
                } else {
                    url = url + '?_layer=1'
                }
                // 弹窗打开要添加的地址
                $.modal.open("修改", url);
            } else {
                // 当前窗口打开要添加的地址
                $.common.jump(url);
            }
        }
        //修改密码
        function editPassword(id){
            layer.prompt({title: '请输入新密码', formType: 1}, function(pass, index){
                $.ajax({
                    url:"/admin/MerchantVerifier/editPassword.html",
                    data:{id:id,password:pass},
                    method:"post",
                    dataType:"json",
                    success:function(res){
                        if(res.code == 1){
                            layer.close(index);
                            layer.msg('修改成功', {icon: 1});
                        }else{
                            layer.msg(res.msg);
                        }
                    }
                })
            });
        }
        // 审核商户
        function check(id) {
            var url = "/admin/MerchantVerifier/check.html?id="+id;
            $.common.jump(url);
        }
        // 查看商户详情
        function see(url) {

            let area  =  [];
            if (isMobile()) {
                area  =  [100 + '%', 100 + '%']
            } else {
                area  =  [900 + 'px', 700 + 'px']
            }
            var index = layer.open({
                type: 2,
                maxmin: true,
                shade: 0.3,
                title: '查看',
                fix: false,
                area: area,
                content: url,
                cancel: function () {
                    return true;
                }
            });
        }
        function isMobile() {
            let flag = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            return flag;
        };
    </script>

    <!--bootstrap table end-->

    <!--底部提示-->
</section>