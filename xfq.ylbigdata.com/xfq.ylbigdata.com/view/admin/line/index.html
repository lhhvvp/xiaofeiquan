
<!--内容开始-->
<section class="content">
    
        
        <!--顶部提示开始-->
        <!--顶部提示结束-->
    <div class="container-fluid">
        <div class="row">
            <!--搜索区域开始-->
            <div class="col-12 search-collapse">
    <form id="search_form">
        <div class="select-list">
                        <ul>
                                <li>
                    <label>名称： </label>
                                                
                            <input type="text" id="search_title" name="title" value=""/>
                                                            </li>
                                <li>
                    <a class="btn btn-primary btn-rounded btn-sm" onclick="$.table.search()"><i class="fa fa-search"></i>&nbsp;搜索</a>
                    <a class="btn btn-warning btn-rounded btn-sm" onclick="resetPre()"><i class="fas fa-sync-alt"></i>&nbsp;重置</a>
                    <input class="hide" type="submit" name="btnSave" value="提交" onclick="$.table.search();return false;"/>
                </li>
            </ul>
                    </div>
    </form>
</div>
            <!--列表区域开始-->
            <div class="col-sm-12 select-table table-striped">
                <div class="btn-group-sm" id="toolbar" role="group">
            <a class="btn btn-success"  onclick="$.operate.add()">
            <i class="fa fa-plus"></i> 新增        </a>
                    <a class="btn btn-warning"  onclick="$.table.export()">
            <i class="fa fa-download"></i> 导出        </a>
            </div>
                <table id="bootstrap-table" data-mobile-responsive="true"></table>
            </div>
        </div>
    </div>
    <script>
        $(function() {
            var options = {
                uniqueId      : "id",         // 表格主键名称，（默认为id，如表主键不为id必须设置主键）
                url           : "/admin/Line/index.html?getList=1",      // 请求后台的URL
                addUrl        : "/admin/Line/add.html",       // 新增的地址
                editUrl       : "/admin/Line/edit.html?id=__id__",      // 修改的地址
                delUrl        : "/admin/Line/del.html",       // 删除的地址
                exportUrl     : "/admin/Line/export.html",    // 导出的地址
                sortUrl       : "/admin/Line/see.html?id=__id__",      // 排序的地址
                sortName      : "id",         // 排序列名称
                sortOrder     : "desc",                 // 排序方式  asc 或者 desc
                pagination    : true,           // 是否进行分页
                parentIdField : "",   // 列表树模式需传递父id字段名（parent_id/pid）
                clickToSelect : true,                   // 默认false不响应，设为true则当点击此行的某处时，会自动选中此行的checkbox/radiobox
                pageSize      : "10",         // 每页显示的行数
                layerOpen     : "1",        // 添加/编辑等页启用layer弹层加载
                emptyTips     : "没有找到匹配的记录",        // 空数据提示信息
                fixedColumns  : true,                   // 是否启用固定列功能
                fixedLeft     : 0,          // 左侧固定列数
                fixedRight    : 1,         // 右侧固定列数
                columns: [
                    {
                        //field: 'state',
                        checkbox: true,
                        // 当某行包含checkbox_disabled时禁止选择
                        formatter: function(value, row, index) {
                            if(row.checkbox_disabled =='1'){
                                 return {
                                     disabled : true
                                }
                             }
                        }
                    },
                                            {
                            field: 'id',  
                            title: '编号', 

                                                            sortable: true,                  
                                                                                                                            
                        },
                                            {
                            field: 'category_id',  
                            title: '分类', 

                                                            sortable: false,     
                                                                formatter: function(value, row, index) {
                                        return row.category_id;
                                    }
                                                                                                
                        },
                                            {
                            field: 'title',  
                            title: '名称', 

                                                            sortable: false,     
                                                                    formatter: function(value, row, index) {
                                            return HTMLDecode(value);
                                        }
                                                                                                
                        },
                                            {
                            field: 'price',  
                            title: '报价', 

                                                            sortable: false,     
                                                                                                                            
                        },
                                            {
                            field: 'tags',  
                            title: '线路景点', 

                                                            sortable: false,     
                                                                                                                            
                        },
                                            {
                            field: 'images',  
                            title: '封面图片', 

                                                            sortable: false,     
                                                                formatter: function(value, row, index) {
                                        if ($.common.isNotEmpty(value)) {
                                            return '<a href="' + value + '" target="_blank"><img class="image_preview" src="' + value + '"></a>';
                                        }
                                    }
                                                                                                
                        },
                                            {
                            field: 'notice',  
                            title: '注意事项', 

                                                            sortable: false,     
                                                                                                                            
                        },
                                            {
                            field: 'create_time',  
                            title: '创建时间', 

                                                            sortable: false,     
                                                                formatter: function(value, row, index) {
                                        return changeDateFormat(value);
                                    }
                                                                                                
                        },
                        {
                            field: 'status',  
                            title: '运营审核', 
                            sortable: false,     
                            formatter: function(value, row, index) {
                                switch (Number(value)) {
                                    case 0:
                                        return '<span class="badge badge-secondary">已被禁用</span>';
                                        break;
                                    case 1:
                                        return '<span class="badge badge-success">通过</span>';
                                        break;
                                    case 2:
                                        return '<span class="badge badge-primary">待审核</span>';
                                        break;
                                    case 3:
                                        return '<span class="badge badge-danger">拒绝通过/span>';
                                        break;
                                    case 4:
                                        return '<span class="badge badge-secondary">整改中</span>';
                                        break;
                                    default:
                                        // code...
                                        break;
                                }
                            }                                                                    
                        },
                        {
                            field: 'tourism_status',  
                            title: '文旅审核', 
                            sortable: false,     
                            formatter: function(value, row, index) {
                                switch (Number(value)) {
                                    case 1:
                                        return '<span class="badge badge-success">通过</span>';
                                        break;
                                    case 2:
                                        return '<span class="badge badge-primary">待审核</span>';
                                        break;
                                    case 3:
                                        return '<span class="badge badge-danger">拒绝通过</span>';
                                        break;
                                    default:
                                        // code...
                                        break;
                                }
                            }                                                                    
                        },
                                            {
                            field: 'right_button',  
                            title: '操作', 

                                                            sortable: false,     
                                                                class : 'text-nowrap',
                                    formatter: function(value, row, index) {
                                        var actions = [];
                                        if(row.status==4){
                                            actions.push('<a class="btn btn-primary btn-xs" href="javascript:void(0)" onclick="$.operate.edit(\'' + row.id + '\')"><i class="fa fa-edit"></i> 编辑</a> '); 
                                        }
                                        if(row.status==0 || row.status==3 || row.status == 4){
                                            actions.push('<a class="btn btn-danger btn-xs confirm" href="javascript:void(0)" onclick="$.operate.edit(\'' + row.id + '\')"><i class="far fa-trash-alt"></i> 删除</a> ');
                                        }
                                        if(row.status==1 && row.tourism_status==1){
                                            actions.push('<a class="btn btn-warning btn-xs confirm" href="javascript:void(0)" onclick="see(\'' + row.id + '\')"><i class="fa fa-search"></i> 查看</a> ');
                                        }
                                        return actions.join('');
                                    }
                                                                                                
                        },
                                    ]
            };
            $.table.init(options);
        });

        // 搜索
        function searchPre() {
            var data = {};
            $.table.search('', data);
        }

        // 重置搜索
        function resetPre() {
            $.form.reset();
        }
        //HTML反转义
        function HTMLDecode(text) {
            var temp = document.createElement("div");
            temp.innerHTML = text;
            var output = temp.innerText || temp.textContent;
            temp = null;
            return output;
        }

        function see(id) {
            var url = '/admin/Line/see.html?id='+id;
            if ($.table._option.layerOpen == "1") {
                // 通过参数隐藏左侧和顶部等数据
                if (url.indexOf('?') != -1) {
                    url = url + '&_layer=1'
                } else {
                    url = url + '?_layer=1'
                }
                // 弹窗打开要添加的地址
                $.modal.open("查看", url);
            } else {
                // 当前窗口打开要添加的地址
                $.common.jump(url);
            }
        }
    </script>

    <!--bootstrap table end-->

    <!--底部提示-->
        
        
    </section>
<!--内容结束-->