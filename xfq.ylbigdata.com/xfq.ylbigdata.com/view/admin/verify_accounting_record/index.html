<!--内容开始-->
<section class="content">
    <!--顶部提示开始-->
    <!--顶部提示结束-->
    <div class="container-fluid">
        <div class="row">
            <!--搜索区域开始-->
            <div class="col-12 search-collapse">
                <form id="search_form">
                    <div class="select-list">
                        <ul>
                            <li>
                                <label>项目结算单号： </label>

                                <input type="text" id="search_no" name="no" value="" />
                            </li>
                            <li>
                                <label>项目名称： </label>

                                <input type="text" id="search_project_name" name="project_name" value="" />
                            </li>
                            <li>
                                <a class="btn btn-primary btn-rounded btn-sm" onclick="$.table.search()"><i
                                        class="fa fa-search"></i>&nbsp;搜索</a>
                                <a class="btn btn-warning btn-rounded btn-sm" onclick="resetPre()"><i
                                        class="fas fa-sync-alt"></i>&nbsp;重置</a>
                                <input class="hide" type="submit" name="btnSave" value="提交"
                                    onclick="$.table.search();return false;" />
                            </li>
                        </ul>
                    </div>
                </form>
            </div>
            <!--列表区域开始-->
            <div class="col-sm-12 select-table table-striped">
                <div class="btn-group-sm" id="toolbar" role="group">
                    <a class="btn btn-success" onclick="$.operate.add()">
                        <i class="fa fa-plus"></i> 新增 </a>
                </div>
                <table id="bootstrap-table" data-mobile-responsive="true"></table>
            </div>
        </div>
    </div>
    <script>
        $(function () {
            var options = {
                uniqueId: "id",         // 表格主键名称，（默认为id，如表主键不为id必须设置主键）
                url: "/admin/VerifyAccountingRecord/index.html?getList=1",      // 请求后台的URL
                addUrl: "/admin/VerifyAccountingRecord/add.html",       // 新增的地址
                editUrl: "/admin/VerifyAccountingRecord/edit.html?id=__id__",      // 修改的地址
                delUrl: "/admin/VerifyAccountingRecord/del.html",       // 删除的地址
                exportUrl: "/admin/VerifyAccountingRecord/export.html",    // 导出的地址
                sortUrl: "/admin/VerifyAccountingRecord/sort.html",      // 排序的地址
                sortName: "id",         // 排序列名称
                sortOrder: "desc",                 // 排序方式  asc 或者 desc
                pagination: true,			// 是否进行分页
                parentIdField: "",   // 列表树模式需传递父id字段名（parent_id/pid）
                clickToSelect: true,				    // 默认false不响应，设为true则当点击此行的某处时，会自动选中此行的checkbox/radiobox
                pageSize: "10",         // 每页显示的行数
                layerOpen: "1",        // 添加/编辑等页启用layer弹层加载
                emptyTips: "没有找到匹配的记录",        // 空数据提示信息
                fixedColumns: true,                   // 是否启用固定列功能
                fixedLeft: 0,          // 左侧固定列数
                fixedRight: 1,         // 右侧固定列数
                columns: [
                    {
                        //field: 'state',
                        checkbox: true,
                        // 当某行包含checkbox_disabled时禁止选择
                        formatter: function (value, row, index) {
                            if (row.checkbox_disabled == '1') {
                                return {
                                    disabled: true
                                }
                            }
                        }
                    },
                    {
                        field: 'id',
                        title: '编号',

                        sortable: true,

                    },
                    {
                        field: 'no',
                        title: '项目结算单号',

                        sortable: true,
                        formatter: function (value, row, index) {
                            return HTMLDecode(value);
                        }

                    },
                    {
                        field: 'project_name',
                        title: '项目名称',

                        sortable: true,
                        formatter: function (value, row, index) {
                            return HTMLDecode(value);
                        }

                    },
                    {
                        field: 'sum_total_price',
                        title: '结算总金额',

                        sortable: true,

                    },
                    {
                        field: 'seller_numbers',
                        title: '渠道数量',

                        sortable: true,

                    },
                    {
                        field: 'tourist_numbers',
                        title: '游客数量',

                        sortable: true,

                    },
                    {
                        field: 'cycle',
                        title: '结算周期',

                        sortable: false,

                    },
                    {
                        field: 'admin_id',
                        title: '运营操作人',

                        sortable: false,

                    },
                    {
                        field: 'create_time',
                        title: '创建时间',

                        sortable: false,
                        formatter: function (value, row, index) {
                            return changeDateFormat(value);
                        }

                    },
                    {
                        field: 'right_button',
                        title: '操作',

                        sortable: false,
                        class: 'text-nowrap',
                        formatter: function (value, row, index) {
                            var actions = [];
                            //?response-content-type=application/octet-stream
                            var url = '/admin/VerifyAccountingRecord/downloadpdf.html?id=' + row.id;

                            actions.push('<a class="btn btn-warning btn-xs" data-href="' + url + '" onclick="DownPdf($(this))"><i class="far fa-arrow-alt-circle-down"></i> 下载PDF</a> ');
                            return actions.join('');
                        }

                    },
                ]
            };
            $.table.init(options);
        });

        // 搜索
        function searchPre() {
            var data = {};
            $.table.search('', data);
        }

        // 重置搜索
        function resetPre() {
            $.form.reset();
        }
        //HTML反转义
        function HTMLDecode(text) {
            var temp = document.createElement("div");
            temp.innerHTML = text;
            var output = temp.innerText || temp.textContent;
            temp = null;
            return output;
        }
        function DownPdf(that){
            $.modal.confirm('确定要生成pdf文件吗？确定后请勿刷新页面!', () => {
                that.addClass("disabled");
                that.removeAttr("onclick");
                window.location.href= `${that.attr("data-href")}`;
            });
        }
    </script>

    <!--bootstrap table end-->

    <!--底部提示-->


</section>
<!--内容结束-->