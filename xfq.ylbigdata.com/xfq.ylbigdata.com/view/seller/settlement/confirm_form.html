<!--内容开始-->
<section class="content">
    <div style="background-color:#fff;width: 100%;border-radius: .25rem;margin-top: 10px;">
        <div class="head-box">
            <div class="item">
                <span class="item-icon-not">1</span>
                创建任务
            </div>
            <div class="item"></div>
            <div class="item">
                <span class="item-icon">
                    <i class="nav-icon fa fa-check"></i>
                </span>
                确认结算信息并提交
            </div>
        </div>
    </div>
    <!--顶部提示开始-->
    <!--顶部提示结束-->
    <div class="container-fluid">
        <div class="callout callout-info">
            <h5><i class="fas fa-info"></i>
                注意
            </h5>
            本次结算日期：<span class="badge badge-danger">{$Request.get.date}</span> 订单数：<span class="badge badge-success"> {$total} 笔</span> 结算金额：<span
                class="badge badge-success"> {$amount_price}元</span>
        </div>
        <div class="col-sm-12 select-table table-striped">
            <table id="bootstrap-table" data-mobile-responsive="true"></table>
        </div>
        <form name="form-builder" class="col-12 form_builder" method="post"
                action="/seller/settlement/addPostSettlement.html" id="form_submit">
            <input type="hidden" name="date" value="{$Request.get.date}">
            <input type="hidden" name="enstr" value="{$enStr}">
            <div class="form">
                <div class="info">
                    <div class="info-item">
                        <div class="form-group">
                            <label for="exampleInputEmail1">结算名称</label>
                            <input type="text" name="title" class="form-control"
                                   value="" placeholder="请输入结算名称">
                        </div>
                    </div>
                </div>
                <div class="row dd_input_group no-gutters " id="form_group_coupon_price" style="width: 70%;">
                    <div class="col-9 col-sm-9 col-md-9 col-lg-6 col-xl-4" style="max-width: 90%;flex: 80%;">
                            <textarea class="form-control" name="remarks" placeholder="请输入结算备注"
                                      style="min-height: 200px;"></textarea>
                    </div>
                </div>

                <div class="info">
                    <div class="info-item">
                        <div class="form-group">
                            <label for="exampleInputEmail1">收款名称</label>
                            <input type="text" name="card_name" class="form-control" value="{$sInfo.card_name}"
                                   placeholder="输入商户名称">
                        </div>
                    </div>
                    <div class="info-item">
                        <div class="form-group">
                            <label for="exampleInputEmail1">开户银行名称</label>
                            <input type="text" name="card_deposit" class="form-control"
                                   value="{$sInfo.card_deposit}" placeholder="输入开户银行名称">
                        </div>

                    </div>
                    <div class="info-item">
                        <div class="form-group">
                            <label for="exampleInputEmail1">基本开户账号</label>
                            <input type="text" name="cart_number" class="form-control" value="{$sInfo.cart_number}"
                                   placeholder="输入开户银行名称">
                        </div>
                    </div>
                </div>
            </div>
            <!---->
                <div class="row dd_input_group form-builder-submit no-gutters">
                    <div
                        class="col-10 col-sm-10 col-md-10 col-lg-10 col-xl-11 offset-sm-2 offset-md-2 offset-lg-2 offset-xl-1">
                        <button type="button" class="btn btn-flat btn-primary" id="submit">提 交</button>
                        <button type="button" class="btn btn-flat btn-default" onclick="javascript :history.back(-1)">返
                            回</button>
                    </div>
                </div>
        </form>
    </div>
    <script>
        $(function () {
            const options = {
                uniqueId: "id",         // 表格主键名称，（默认为id，如表主键不为id必须设置主键）
                url: "/seller/Settlement/confirm_form.html?getList=1&dateStr="+`{$Request.get.date}`,      // 请求后台的URL
                sortName: "id",         // 排序列名称
                sortOrder: "desc",                 // 排序方式  asc 或者 desc
                pagination: true,			// 是否进行分页
                parentIdField: "",   // 列表树模式需传递父id字段名（parent_id/pid）
                clickToSelect: true,				    // 默认false不响应，设为true则当点击此行的某处时，会自动选中此行的checkbox/radiobox
                pageSize: "10",         // 每页显示的行数
                layerOpen: "1",        // 添加/编辑等页启用layer弹层加载
                emptyTips: "没有找到匹配的记录",        // 空数据提示信息
                fixedColumns: true,                   // 是否启用固定列功能
                fixedLeft: 0,          // 左侧固定列数
                fixedRight: 1,         // 右侧固定列数
                columns: [
                    /*{
                        //field: 'state',
                        checkbox: true,
                        // 当某行包含checkbox_disabled时禁止选择
                        formatter: function (value, row, index) {
                            if (row.checkbox_disabled == '1') {
                                return {
                                    disabled: true
                                }
                            }
                        }
                    },*/
                    {
                        field: 'id',
                        title: '编号',
                        sortable: true,
                    },
                    {
                        field: 'trade_no',
                        title: '订单编号[内部]',
                        sortable: false,
                    },
                    {
                        field: 'contact_man',
                        title: '订单联系人',
                        sortable: true,
                        formatter: function (value, row, index) {
                            return HTMLDecode(value);
                        }
                    },
                    {
                        field: 'contact_phone',
                        title: '联系号码',
                        sortable: false,
                        formatter: function (value, row, index) {
                            return HTMLDecode(value);
                        }
                    },
                    {
                        field: 'contact_certno',
                        title: '证件号',
                        sortable: true,
                        formatter: function (value, row, index) {
                            return HTMLDecode(value);
                        }
                    },
                    {
                        field: 'origin_price',
                        title: '订单原价',
                        sortable: true,
                        formatter: function (value, row, index) {
                            return HTMLDecode(value);
                        }
                    },
                    {
                        field: 'amount_price',
                        title: '实际支付',
                        sortable: true,
                        formatter: function (value, row, index) {
                            return HTMLDecode(value);
                        }
                    },
                    {
                        field: 'type_text',
                        title: '支付渠道',
                        sortable: true,
                        formatter: function (value, row, index) {
                            return HTMLDecode(value);
                        }
                    },
                    {
                        field: 'uuid',
                        title: '下单人',
                        sortable: true,
                        formatter: function (value, row, index) {
                            return HTMLDecode(value);
                        }
                    },
                    {
                        field: 'payment_datetime',
                        title: '支付到账时间',
                        sortable: true,
                        formatter: function (value, row, index) {
                            return HTMLDecode(value);
                        }
                    },
                    {
                        field: 'create_time',
                        title: '下单时间',
                        sortable: true,
                        formatter: function (value, row, index) {
                            return HTMLDecode(value);
                        }
                    }
                ]
            };
            $.table.init(options);
        });

        // 搜索
        function searchPre() {
            var data = {};
            $.table.search('', data);
        }

        // 重置搜索
        function resetPre() {
            $.form.reset();
        }

        //HTML反转义
        function HTMLDecode(text) {
            var temp = document.createElement("div");
            temp.innerHTML = text;
            var output = temp.innerText || temp.textContent;
            temp = null;
            return output;
        }

        // 表单提交
        let isSubmitting = false;
        const $submitButton = $("#submit");
        const $formSubmit = $("#form_submit");

        $submitButton.click(() => {
          if (!isSubmitting) {
            isSubmitting = true;
            $submitButton.prop("disabled", true);
            layer.msg('生成中请耐心等待。请勿刷新页面...', { icon: 16, time: 100000, shade: [0.5, '#000', true] });
            $formSubmit.submit();
            //$submitButton.prop("disabled", false);
          } else {
            layer.msg('请勿重复提交');
            return false;
          }
        });
    </script>

    <!--bootstrap table end-->

    <!--底部提示-->
</section>
<style>
    .head-box {
        margin: auto;
        height: 50px;
        display: flex;
        justify-content: space-between;
        margin-bottom: 20px;
        width: 500px;
    }

    .form {
        display: flex;
    }

    .info {
        width: 30%;
        padding-top: 10px;
        display: flex;
        justify-content: center;
        flex-direction: column;
        align-items: center;
    }

    .info .info-item {
        width: 90%;
        display: flex;
    }

    .head-box .item {
        position: relative;
        display: flex;
        font-weight: bold;
        align-items: center;
        justify-content: center;
    }

    .head-box .item:nth-of-type(2) {
        width: 200px;
    }

    .head-box .item .item-icon {
        width: 30px;
        height: 30px;
        margin-right: 10px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #fff;
        font-size: 16px;
        background-color: #204d74;
    }

    .head-box .item .item-icon-not {
        width: 30px;
        height: 30px;
        margin-right: 10px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #204d7490;
        font-size: 16px;
        border: 2px solid #204d7490;
    }

    .head-box .item:nth-of-type(2)::after {
        content: "";
        width: 90%;
        height: 4px;
        border-radius: 20px;
        position: absolute;
        background-color: #204d74;
    }
</style>
