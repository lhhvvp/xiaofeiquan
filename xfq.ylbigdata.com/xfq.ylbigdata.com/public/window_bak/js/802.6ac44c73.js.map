{"version":3,"file":"js/802.6ac44c73.js","mappings":"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","sources":["webpack://ticket/./src/views/index/index.vue","webpack://ticket/./src/views/index/index.vue?f455","webpack://ticket/./node_modules/element-plus/dist/locale/zh-cn.mjs"],"sourcesContent":["<template>\r\n  <div class=\"main\">\r\n    <div class=\"main-left backdrop-filter\">\r\n      <div class=\"left-top\">\r\n        <div class=\"title\">票务种类</div>\r\n        <div class=\"main-box \">\r\n\r\n          <div class=\"item\" v-for=\"(item,index) in list\" :key=\"index\">\r\n            <div class=\"item-title\">{{ item.ticket.title }}</div>\r\n\r\n            <div class=\"item-number\" style=\"margin-bottom: 8px\"><span>数量：</span>\r\n              <el-input-number min=\"0\" size=\"small\" v-model=\"item.number\" :max=\"item.stock\" style=\"width: 90px\"\r\n                               @change=\"change($event,item)\"></el-input-number>\r\n            </div>\r\n\r\n            <div class=\"item-number\"><span style=\"font-size: 10px\">库存：{{ item.stock }}张，</span>\r\n              <span style=\"font-size: 10px\">价格：{{ item.price }}元</span>\r\n            </div>\r\n          </div>\r\n\r\n          <div v-if=\"list.length === 0\"\r\n               style=\"width: 100%;text-align: center;color: var(--el-text-color-secondary);font-size:14px;padding: 50px 0\">\r\n            当天暂无门票\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n      <div class=\"left-bottom\">\r\n        <div class=\"title\">票务订单信息</div>\r\n        <div class=\"main-box\">\r\n          <el-table :data=\"FormData\" sum-text=\"合计\" empty-text=\"请选择门票\" show-summary stripe border\r\n                    style=\"width: 100%\" height=\"220\">\r\n            <el-table-column prop=\"id\" label=\"编号\" width=\"80\"/>\r\n            <el-table-column prop=\"title\" label=\"门票名称\"/>\r\n            <el-table-column sortable prop=\"price\" label=\"零售价(元)\" width=\"180\"/>\r\n            <el-table-column sortable prop=\"number\" label=\"购买数量（张）\" width=\"180\"/>\r\n            <el-table-column sortable prop=\"totalPrice\" label=\"单项小计（元）\" width=\"180\"/>\r\n          </el-table>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"left-footer\">\r\n        <div class=\"title\">游客信息</div>\r\n        <div class=\"main-box\">\r\n          <el-form :model=\"form\" label-width=\"120px\"\r\n                   style=\"background: #f7f7f7;display: flex;align-items: center; padding: 10px\" ref=\"ruleForms\"\r\n                   :rules=\"rules\">\r\n            <el-form-item label=\"姓名\" style=\"width: 33%;margin: 15px 0\" class=\"w-50 m-2\" prop=\"name\">\r\n              <el-input v-model=\"form.name\" placeholder=\"请输入姓名\"/>\r\n            </el-form-item>\r\n            <el-form-item label=\"身份证号\" style=\"width: 33%;margin: 15px 0\" prop=\"idcard\">\r\n              <el-input v-model=\"form.idcard\" placeholder=\"请输入身份证号\"/>\r\n            </el-form-item>\r\n            <el-form-item label=\"手机号\" style=\"width: 33%;margin: 15px 0\" prop=\"phone\">\r\n              <el-input v-model=\"form.phone\" placeholder=\"请输入手机号\"/>\r\n            </el-form-item>\r\n            <el-button style=\"margin-left: 10px;\" @click=\"ReadIDCard()\"\r\n                       v-loading.fullscreen.lock=\"fullscreenLoading\">识别身份证\r\n            </el-button>\r\n          </el-form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"main-right\">\r\n      <div class=\"right-top backdrop-filter\">\r\n        <div class=\"title\">游玩日期</div>\r\n        <div class=\"main-box\">\r\n          <div class=\"demo-date-picker\" style=\"padding-top: 20px\">\r\n            <el-config-provider :locale=\"zhCn\">\r\n              <el-date-picker\r\n                  v-model=\"value\"\r\n                  type=\"date\"\r\n                  placeholder=\"请选择时间\"\r\n                  format=\"YYYY/MM/DD\"\r\n                  value-format=\"YYYY-MM-DD\"\r\n                  style=\"width: 100%;\"\r\n                  @change=\"dateChange\"\r\n                  :disabled-date=\"disabledDate\"\r\n              >\r\n                <template #default=\"cell\">\r\n                  <div class=\"cell\" :class=\"{ current: cell.isCurrent }\">\r\n                    <span class=\"text\">{{ cell.text }}</span>\r\n                    <span v-if=\"isHoliday(cell)\" class=\"holiday\"/>\r\n                  </div>\r\n                </template>\r\n              </el-date-picker>\r\n            </el-config-provider>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"right-cent backdrop-filter\">\r\n        <div class=\"title\">票价总计</div>\r\n        <div class=\"total-price\">\r\n          <span style=\"font-size: 16px\">￥</span>\r\n          {{ totalPrice.toFixed(2) }}\r\n        </div>\r\n      </div>\r\n      <div class=\"right-bottom backdrop-filter\">\r\n        <div class=\"title\">付款方式</div>\r\n        <div class=\"main-box\">\r\n          <div class=\"item\" v-for=\"(item,index) in payTypes\" :key=\"index\" @click=\"paySbmit(item.type)\">\r\n            <div class=\"img\" :style=\"'background-image:url('+item.url+')'\"></div>\r\n            <div class=\"tit\" style=\"color: #666666;font-size: 14px;\">{{ item.title }}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <el-dialog\r\n        v-model=\"dialogVisible\"\r\n        title=\"提交订单\"\r\n        width=\"30%\"\r\n        :before-close=\"handleClose\"\r\n    >\r\n      <span v-if=\"FromPayType !== 'cash'\">您确定提交订单吗？</span>\r\n      <div v-if=\"FromPayType === 'cash'\">\r\n        <el-form-item label=\"本单收款\" style=\"width: 100%;margin: 15px 0\" prop=\"idcard\">\r\n          <el-input v-model=\"proceeds\" placeholder=\"本单收款\"/>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"本单金额\" style=\"width: 100%;margin: 15px 0\" prop=\"idcard\">\r\n          <el-input v-model=\"totalPrice\" disabled placeholder=\"本单收款\"/>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"本单找零\" style=\"width: 100%;margin: 15px 0\" prop=\"idcard\">\r\n          <el-input :value=\"(proceeds - totalPrice).toFixed(2)\" disabled placeholder=\"找零\"/>\r\n        </el-form-item>\r\n      </div>\r\n      <template #footer>\r\n      <span class=\"dialog-footer\">\r\n        <el-button @click=\"dialogVisible = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"submit()\">\r\n          提交订单\r\n        </el-button>\r\n      </span>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref, onMounted} from \"vue\";\r\nimport zhCn from 'element-plus/dist/locale/zh-cn.mjs'\r\nimport {useStore} from \"vuex\";\r\nimport {ElMessage} from \"element-plus\";\r\n\r\nimport cash from '../../assets/icon/xj.png'\r\nimport alipay from '../../assets/icon/zfbPay.png'\r\nimport unionpay from '../../assets/icon/yl.png'\r\nimport wxPay from '../../assets/icon/wxPay.png'\r\n\r\n\r\nconst store = useStore();   //vue 缓存\r\nconst value = ref('1970-01-01');  //接口的时间\r\nconst holidays = [];      //可以选的时间\r\nconst isHoliday = ({dayjs}) => {\r\n  return holidays.includes(dayjs.format('YYYY-MM-DD'))\r\n};\r\n\r\nfunction disabledDate(v) {\r\n  return v.getTime() < (new Date().getTime() - 86400000);\r\n}\r\n\r\n\r\nconst valuation = ref(null);  //赋值操作\r\nconst fullscreenLoading = ref(false);\r\nconst websockets = ref(null), isconncet = ref(false);\r\n\r\nfunction socketChange() {\r\n  let state = websockets.value.readyState;\r\n  //读身份证\r\n  if (1 === state) {\r\n    isconncet.value = true;\r\n  }\r\n  if (3 === state) {\r\n    isconncet.value = false;\r\n  }\r\n}\r\n\r\nfunction OcrRecognition() {\r\n  if (!isconncet.value) {\r\n    // 1. 创建websockets对象，参数为服务器websockets地址\r\n    var url = \"ws:127.0.0.1:7415\"\r\n    websockets.value = new WebSocket(url);\r\n    websockets.value.onopen = () => socketChange();\r\n    //监听接收消息的情况\r\n    websockets.value.onmessage = (res) => {\r\n      if (res.data == \"failed to obtain ID card information\") {\r\n        document.querySelector(\"#message\").innerHTML += `<p>接收数据: ${res.data}</p>`\r\n        return;\r\n      }\r\n      fullscreenLoading.value = false;\r\n      var alldata = res.data.split(\"|\");\r\n      if (alldata.length >= 17) {\r\n        eval(valuation.value).value.name = alldata[1]\r\n        eval(valuation.value).value.idcard = alldata[6]\r\n      } else {\r\n        ElMessage({\r\n          message: res.data,\r\n          type: 'warning',\r\n        })\r\n      }\r\n    }\r\n    //监听关闭时的状态变化\r\n\r\n  } else {\r\n    closeConnect();\r\n  }\r\n};\r\n\r\n/**\r\n *   关闭连接\r\n *\r\n */\r\nfunction closeConnect() {\r\n  websockets.value.close();\r\n};\r\n\r\nfunction ReadIDCard(vals) {\r\n\r\n  if (!isconncet.value) {\r\n    ElMessage({\r\n      message: '未连接服务',\r\n      type: 'warning',\r\n    })\r\n  } else {\r\n\r\n    if (!vals) {\r\n      valuation.value = 'form';\r\n    }\r\n\r\n    let paramTimeOut = 10000;\r\n    paramTimeOut = \"timeout=\" + paramTimeOut;\r\n    var parameterAll = paramTimeOut;\r\n    let val = \"03?\" + parameterAll;\r\n    websockets.value.send(val);\r\n    fullscreenLoading.value = true;\r\n  }\r\n}\r\n\r\n\r\nonMounted(() => {\r\n  OcrRecognition();\r\n})\r\n\r\n\r\n//可以选的时间\r\nconst list = ref([]);//门票数据\r\n\r\nconst payTypes = ref([\r\n  {\r\n    title: \"微信\",\r\n    url: wxPay,\r\n    type: \"weixin\",\r\n  }, {\r\n    title: \"支付宝\",\r\n    url: alipay,\r\n    type: \"alipay\",\r\n  }, {\r\n    title: \"现金\",\r\n    url: cash,\r\n    type: \"cash\",\r\n  }, {\r\n    title: \"银联\",\r\n    url: unionpay,\r\n    type: \"unionpay\",\r\n  }\r\n]);\r\nconst FromPayType = ref(null);\r\n\r\nconst dialogVisible = ref(false);\r\nconst handleClose = (done) => {\r\n  done()\r\n}\r\n\r\nconst ruleForms = ref(null);\r\n\r\nconst rules = {\r\n  name: [\r\n    {required: true, message: '请输入姓名', trigger: 'blur'},\r\n  ],\r\n  phone: [\r\n    {required: true, message: '请输入手机号', trigger: 'blur'},\r\n    {pattern: /^1[3456789]\\d{9}$/, message: '手机号码格式不正确', trigger: 'blur'}\r\n  ],\r\n  idcard: [\r\n    {required: true, message: '请输入身份证号', trigger: 'blur'},\r\n    {\r\n      pattern: /^(^[1-9]\\d{7}((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])\\d{3}$)|(^[1-9]\\d{5}[1-9]\\d{3}((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])((\\d{4})|\\d{3}[Xx])$)$/,\r\n      message: '身份证号码格式不正确',\r\n      trigger: 'blur'\r\n    }\r\n\r\n  ]\r\n}\r\n\r\nconst paySbmit = function (val) {\r\n  ruleForms.value.validate((valid) => {\r\n    if (valid) {\r\n      if (FormData.value.length === 0) {\r\n        ElMessage({\r\n          message: '请选择门票',\r\n          type: 'warning',\r\n        });\r\n        return false;\r\n\r\n      } else {\r\n        FromPayType.value = val;\r\n        dialogVisible.value = true;\r\n      }\r\n\r\n    }\r\n  })\r\n\r\n};\r\nconst form = ref({\r\n  name: null,\r\n  phone: null,\r\n  idcard: null,\r\n});\r\n\r\nconst loading = ref(false);//加载loading\r\nconst submit = () => {\r\n\r\n  dialogVisible.value = false;\r\n\r\n  let paytype = FromPayType.value;\r\n\r\n  let ticket_date = value.value;\r\n\r\n  let data = FormData.value.map(item => {\r\n    return {uuno: item.uuno, number: item.number, price: Number(item.price) * Number(item.number)}\r\n  });\r\n  data = JSON.stringify(data);\r\n\r\n  loading.value = true;\r\n  ruleForms.value.validate((valid) => {\r\n    if (valid) {\r\n      let userinfo = store.state.UserInfo;\r\n      let {name: contact_man, phone: contact_phone, idcard: contact_certno} = form.value;\r\n\r\n      let contact = {contact_certno, contact_phone, contact_man};\r\n\r\n      contact = JSON.stringify(contact);\r\n\r\n      let option = {contact, data, paytype, ticket_date, uuid: userinfo.uuid,};\r\n\r\n      store.dispatch('paySubmit', option)\r\n          .then((res) => {\r\n            if (res.code === 1) {\r\n              loading.value = false;\r\n              ElMessage({\r\n                message: res.msg || 'error', type: 'error', showClose: true, duration: 3 * 1000\r\n              });\r\n            } else {\r\n              loading.value = false;\r\n              ElMessage({\r\n                message: res.msg || 'success', type: 'success', showClose: true, duration: 3 * 1000\r\n              });\r\n              let timer = setTimeout(() => {\r\n                window.location.reload();\r\n                clearTimeout(timer);\r\n              }, 1500)\r\n            }\r\n\r\n          })\r\n          .catch(() => {\r\n            loading.value = false\r\n          })\r\n    }\r\n  })\r\n\r\n\r\n};\r\nconst init = (date = '') => {\r\n  let userinfo = store.state.UserInfo;\r\n  let data = {\r\n    channel: 'casual',\r\n    oneday: date,\r\n  }\r\n  if (userinfo) {\r\n    data.bstr = userinfo.businesstr;\r\n  }\r\n\r\n  store.dispatch('getTicketPirce', data)\r\n      .then((res) => {\r\n        list.value = [];\r\n        if (res.code === 0) {\r\n          if (res.data) {\r\n            value.value = res.data[0].date;\r\n            res.data.forEach(item => {\r\n              item.number = 0;\r\n            });\r\n          }\r\n          list.value = res.data;\r\n        }\r\n      })\r\n      .catch(() => {\r\n      })\r\n};\r\ninit();\r\n\r\nconst FormDataSet = new Set([]);    //选择的set数据id\r\nconst FormData = ref([]);     //选择的数据\r\n\r\nconst proceeds = ref(0); //收款\r\n\r\nconst totalPrice = ref(0);\r\n\r\n\r\nconst dateChange = function (e) {\r\n  // 日期选择器\r\n  init(e);\r\n  FormDataSet.clear();\r\n  FormData.value = [];\r\n}\r\nconst change = function (e, val) {\r\n  if (FormDataSet.has(val.ticket.id)) {\r\n    //有的时候\r\n    FormData.value.forEach(item => {\r\n      if (item.uuno === val.ticket.id) {\r\n        item.number = e;\r\n        item.totalPrice = Number(e) * Number(val.price);\r\n      }\r\n    });\r\n    if (e === 0) {\r\n      FormData.value.forEach((item, index) => {\r\n        if (item.uuno === val.ticket.id) {\r\n          FormData.value.splice(index, 1);\r\n        }\r\n      });\r\n      FormDataSet.delete(val.ticket.id);\r\n    }\r\n    ;\r\n  } else {\r\n    //没有;\r\n    FormDataSet.add(val.ticket.id);\r\n    FormData.value.push({\r\n      id: val.ticket.id,\r\n      number: e,\r\n      price: val.price,\r\n      uuno: val.ticket.id,\r\n      title: val.ticket.title,\r\n      totalPrice: Number(e) * Number(val.price),\r\n    });\r\n  }\r\n  ;\r\n  totalPrice.value = 0;\r\n  FormData.value.forEach(item => {\r\n    totalPrice.value += item.totalPrice;\r\n  })\r\n\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.main {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  left: 0;\r\n  justify-content: space-between;\r\n\r\n}\r\n\r\n.main .main-left {\r\n  padding: 20px;\r\n  width: calc(75% - 60px);\r\n  height: calc(100% - 42px);\r\n}\r\n\r\n.main .main-right {\r\n  width: 25%;\r\n  height: 100%;\r\n\r\n}\r\n\r\n.main .main-right {\r\n  border-radius: 10px;\r\n}\r\n\r\n.main .main-left {\r\n  border-radius: 10px;\r\n  border: 1px solid #409eff50;\r\n}\r\n\r\n.main .main-right .right-top {\r\n  margin-bottom: 20px;\r\n  height: 20%;\r\n  padding: 20px;\r\n  width: calc(100% - 42px);\r\n  border-radius: 10px;\r\n  border: 1px solid #409eff50;\r\n\r\n}\r\n\r\n.main .main-right .right-cent {\r\n  border-radius: 10px;\r\n  padding: 20px;\r\n  height: 40%;\r\n  margin-bottom: 20px;\r\n  width: calc(100% - 42px);\r\n  border: 1px solid #409eff50;\r\n}\r\n\r\n.main .main-right .right-cent .total-price {\r\n  width: 100%;\r\n  height: 70%;\r\n  text-align: center;\r\n  font-size: 45px;\r\n  font-weight: bold;\r\n  color: var(--el-color-danger);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.main .main-right .right-bottom {\r\n  padding: 20px;\r\n  height: calc(40% - 166px);\r\n  width: calc(100% - 42px);\r\n  border-radius: 10px;\r\n  border: 1px solid #409eff50;\r\n}\r\n\r\n.main .main-right .right-bottom .main-box {\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: space-around;\r\n  margin-top: 40px;\r\n}\r\n\r\n.main .main-right .right-bottom .main-box .item {\r\n  width: 100%;\r\n  text-align: center;\r\n}\r\n\r\n.main .main-right .right-bottom .main-box .item .img {\r\n  width: 50px;\r\n  height: 50px;\r\n  margin: 0 auto 10px;\r\n  background-size: cover;\r\n}\r\n\r\n\r\n.main .main-left .left-top {\r\n  width: 100%;\r\n  margin-bottom: 2%;\r\n  border-bottom: 1px solid #f7f7f7;\r\n}\r\n\r\n.main .main-left .left-top .main-box {\r\n  overflow: auto;\r\n  height: 210px;\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.main .main-left .left-top .main-box .item {\r\n  width: calc(220px - 20px);\r\n  padding: 10px;\r\n  height: 80px;\r\n  background: #f7f7f7;\r\n  margin-right: 10px;\r\n  margin-bottom: 10px;\r\n  border-radius: 10px;\r\n  display: inline-block;\r\n}\r\n\r\n.item-title {\r\n  font-weight: bold;\r\n  margin-bottom: 10px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  display: -webkit-box;\r\n  -webkit-line-clamp: 1;\r\n  -webkit-box-orient: vertical;\r\n}\r\n\r\n.item-number {\r\n  font-size: 14px;\r\n  color: #838383;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.main .main-left .left-bottom {\r\n  width: 100%;\r\n  height: 36%;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.title {\r\n  font-size: 18px;\r\n  font-weight: bold;\r\n  color: var(--el-menu-hover-text-color);\r\n  margin-bottom: 30px;\r\n  position: relative;\r\n  padding-left: 15px;\r\n}\r\n\r\n.title:before {\r\n  position: absolute;\r\n  content: \"\";\r\n  width: 6px;\r\n  height: 80%;\r\n  top: 11%;\r\n  left: 0;\r\n  border-radius: 10px;\r\n  background: var(--el-menu-hover-text-color);\r\n}\r\n\r\n.cell {\r\n  height: 30px;\r\n  padding: 3px 0;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.cell .text {\r\n  width: 24px;\r\n  height: 24px;\r\n  display: block;\r\n  margin: 0 auto;\r\n  line-height: 24px;\r\n  position: absolute;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  border-radius: 50%;\r\n}\r\n\r\n.cell.current .text {\r\n  background: #626aef;\r\n  color: #fff;\r\n}\r\n\r\n.cell .holiday {\r\n  position: absolute;\r\n  width: 6px;\r\n  height: 6px;\r\n  background: var(--el-color-danger);\r\n  border-radius: 50%;\r\n  bottom: 0px;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n}\r\n</style>","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=ab7f8aac&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-ab7f8aac\"]])\n\nexport default __exports__","/*! Element Plus v2.3.9 */\n\nvar zhCn = {\n  name: \"zh-cn\",\n  el: {\n    colorpicker: {\n      confirm: \"\\u786E\\u5B9A\",\n      clear: \"\\u6E05\\u7A7A\"\n    },\n    datepicker: {\n      now: \"\\u6B64\\u523B\",\n      today: \"\\u4ECA\\u5929\",\n      cancel: \"\\u53D6\\u6D88\",\n      clear: \"\\u6E05\\u7A7A\",\n      confirm: \"\\u786E\\u5B9A\",\n      selectDate: \"\\u9009\\u62E9\\u65E5\\u671F\",\n      selectTime: \"\\u9009\\u62E9\\u65F6\\u95F4\",\n      startDate: \"\\u5F00\\u59CB\\u65E5\\u671F\",\n      startTime: \"\\u5F00\\u59CB\\u65F6\\u95F4\",\n      endDate: \"\\u7ED3\\u675F\\u65E5\\u671F\",\n      endTime: \"\\u7ED3\\u675F\\u65F6\\u95F4\",\n      prevYear: \"\\u524D\\u4E00\\u5E74\",\n      nextYear: \"\\u540E\\u4E00\\u5E74\",\n      prevMonth: \"\\u4E0A\\u4E2A\\u6708\",\n      nextMonth: \"\\u4E0B\\u4E2A\\u6708\",\n      year: \"\\u5E74\",\n      month1: \"1 \\u6708\",\n      month2: \"2 \\u6708\",\n      month3: \"3 \\u6708\",\n      month4: \"4 \\u6708\",\n      month5: \"5 \\u6708\",\n      month6: \"6 \\u6708\",\n      month7: \"7 \\u6708\",\n      month8: \"8 \\u6708\",\n      month9: \"9 \\u6708\",\n      month10: \"10 \\u6708\",\n      month11: \"11 \\u6708\",\n      month12: \"12 \\u6708\",\n      weeks: {\n        sun: \"\\u65E5\",\n        mon: \"\\u4E00\",\n        tue: \"\\u4E8C\",\n        wed: \"\\u4E09\",\n        thu: \"\\u56DB\",\n        fri: \"\\u4E94\",\n        sat: \"\\u516D\"\n      },\n      months: {\n        jan: \"\\u4E00\\u6708\",\n        feb: \"\\u4E8C\\u6708\",\n        mar: \"\\u4E09\\u6708\",\n        apr: \"\\u56DB\\u6708\",\n        may: \"\\u4E94\\u6708\",\n        jun: \"\\u516D\\u6708\",\n        jul: \"\\u4E03\\u6708\",\n        aug: \"\\u516B\\u6708\",\n        sep: \"\\u4E5D\\u6708\",\n        oct: \"\\u5341\\u6708\",\n        nov: \"\\u5341\\u4E00\\u6708\",\n        dec: \"\\u5341\\u4E8C\\u6708\"\n      }\n    },\n    select: {\n      loading: \"\\u52A0\\u8F7D\\u4E2D\",\n      noMatch: \"\\u65E0\\u5339\\u914D\\u6570\\u636E\",\n      noData: \"\\u65E0\\u6570\\u636E\",\n      placeholder: \"\\u8BF7\\u9009\\u62E9\"\n    },\n    cascader: {\n      noMatch: \"\\u65E0\\u5339\\u914D\\u6570\\u636E\",\n      loading: \"\\u52A0\\u8F7D\\u4E2D\",\n      placeholder: \"\\u8BF7\\u9009\\u62E9\",\n      noData: \"\\u6682\\u65E0\\u6570\\u636E\"\n    },\n    pagination: {\n      goto: \"\\u524D\\u5F80\",\n      pagesize: \"\\u6761/\\u9875\",\n      total: \"\\u5171 {total} \\u6761\",\n      pageClassifier: \"\\u9875\",\n      page: \"\\u9875\",\n      prev: \"\\u4E0A\\u4E00\\u9875\",\n      next: \"\\u4E0B\\u4E00\\u9875\",\n      currentPage: \"\\u7B2C {pager} \\u9875\",\n      prevPages: \"\\u5411\\u524D {pager} \\u9875\",\n      nextPages: \"\\u5411\\u540E {pager} \\u9875\",\n      deprecationWarning: \"\\u4F60\\u4F7F\\u7528\\u4E86\\u4E00\\u4E9B\\u5DF2\\u88AB\\u5E9F\\u5F03\\u7684\\u7528\\u6CD5\\uFF0C\\u8BF7\\u53C2\\u8003 el-pagination \\u7684\\u5B98\\u65B9\\u6587\\u6863\"\n    },\n    messagebox: {\n      title: \"\\u63D0\\u793A\",\n      confirm: \"\\u786E\\u5B9A\",\n      cancel: \"\\u53D6\\u6D88\",\n      error: \"\\u8F93\\u5165\\u7684\\u6570\\u636E\\u4E0D\\u5408\\u6CD5!\"\n    },\n    upload: {\n      deleteTip: \"\\u6309 delete \\u952E\\u53EF\\u5220\\u9664\",\n      delete: \"\\u5220\\u9664\",\n      preview: \"\\u67E5\\u770B\\u56FE\\u7247\",\n      continue: \"\\u7EE7\\u7EED\\u4E0A\\u4F20\"\n    },\n    table: {\n      emptyText: \"\\u6682\\u65E0\\u6570\\u636E\",\n      confirmFilter: \"\\u7B5B\\u9009\",\n      resetFilter: \"\\u91CD\\u7F6E\",\n      clearFilter: \"\\u5168\\u90E8\",\n      sumText: \"\\u5408\\u8BA1\"\n    },\n    tree: {\n      emptyText: \"\\u6682\\u65E0\\u6570\\u636E\"\n    },\n    transfer: {\n      noMatch: \"\\u65E0\\u5339\\u914D\\u6570\\u636E\",\n      noData: \"\\u65E0\\u6570\\u636E\",\n      titles: [\"\\u5217\\u8868 1\", \"\\u5217\\u8868 2\"],\n      filterPlaceholder: \"\\u8BF7\\u8F93\\u5165\\u641C\\u7D22\\u5185\\u5BB9\",\n      noCheckedFormat: \"\\u5171 {total} \\u9879\",\n      hasCheckedFormat: \"\\u5DF2\\u9009 {checked}/{total} \\u9879\"\n    },\n    image: {\n      error: \"\\u52A0\\u8F7D\\u5931\\u8D25\"\n    },\n    pageHeader: {\n      title: \"\\u8FD4\\u56DE\"\n    },\n    popconfirm: {\n      confirmButtonText: \"\\u786E\\u5B9A\",\n      cancelButtonText: \"\\u53D6\\u6D88\"\n    }\n  }\n};\n\nexport { zhCn as default };\n"],"names":["store","useStore","value","ref","holidays","isHoliday","dayjs","includes","format","disabledDate","v","getTime","Date","valuation","fullscreenLoading","websockets","isconncet","socketChange","state","readyState","OcrRecognition","closeConnect","url","WebSocket","onopen","onmessage","res","data","alldata","split","length","eval","name","idcard","ElMessage","message","type","document","querySelector","innerHTML","close","ReadIDCard","vals","paramTimeOut","parameterAll","val","send","onMounted","list","payTypes","title","wxPay","alipay","cash","unionpay","FromPayType","dialogVisible","handleClose","done","ruleForms","rules","required","trigger","phone","pattern","paySbmit","validate","valid","FormData","form","loading","submit","paytype","ticket_date","map","item","uuno","number","price","Number","JSON","stringify","userinfo","UserInfo","contact_man","contact_phone","contact_certno","contact","option","uuid","dispatch","then","code","msg","showClose","duration","timer","setTimeout","window","location","reload","clearTimeout","catch","init","date","channel","oneday","bstr","businesstr","forEach","FormDataSet","Set","proceeds","totalPrice","dateChange","e","clear","change","has","ticket","id","index","splice","delete","add","push","__exports__","zhCn","el","colorpicker","confirm","datepicker","now","today","cancel","selectDate","selectTime","startDate","startTime","endDate","endTime","prevYear","nextYear","prevMonth","nextMonth","year","month1","month2","month3","month4","month5","month6","month7","month8","month9","month10","month11","month12","weeks","sun","mon","tue","wed","thu","fri","sat","months","jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec","select","noMatch","noData","placeholder","cascader","pagination","goto","pagesize","total","pageClassifier","page","prev","next","currentPage","prevPages","nextPages","deprecationWarning","messagebox","error","upload","deleteTip","preview","continue","table","emptyText","confirmFilter","resetFilter","clearFilter","sumText","tree","transfer","titles","filterPlaceholder","noCheckedFormat","hasCheckedFormat","image","pageHeader","popconfirm","confirmButtonText","cancelButtonText"],"sourceRoot":""}