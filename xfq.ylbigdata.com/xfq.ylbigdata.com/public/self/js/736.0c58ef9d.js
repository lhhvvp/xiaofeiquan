"use strict";(self["webpackChunkticket"]=self["webpackChunkticket"]||[]).push([[736],{4492:function(e,t,a){a.r(t),a.d(t,{default:function(){return re}});var n=a(3396),i=a(4870),l=a(9242),o=a(7139),s=a(5076),c=a(814),d=a(65),r=a(7178);const m=e=>((0,n.dD)("data-v-18d453dc"),e=e(),(0,n.Cn)(),e),u={class:"main backdrop-filter"},_={class:"info-item"},p={class:"item-info"},f=m((()=>(0,n._)("div",{class:"item-info-lable"},"订单号：",-1))),v={class:"item-info-centent"},g={class:"item-info"},w=m((()=>(0,n._)("div",{class:"item-info-lable"},"订单金额：",-1))),b={class:"item-info-centent"},h={class:"item-info"},k=m((()=>(0,n._)("div",{class:"item-info-lable"},"联系人：",-1))),y={class:"item-info-centent"},z={class:"item-info"},x=m((()=>(0,n._)("div",{class:"item-info-lable"},"联系方式：",-1))),C={class:"item-info-centent"},D={class:"item-info"},U=m((()=>(0,n._)("div",{class:"item-info-lable"},"下单时间：",-1))),V={class:"item-info-centent"},W={class:"item-info"},T=m((()=>(0,n._)("div",{class:"item-info-lable"},"退款状态：",-1))),H={class:"item-info-centent"},q={class:"info-item"},M={class:"info-tit"},j={class:"item-info"},F=m((()=>(0,n._)("div",{class:"item-info-lable"},"门票名称：",-1))),S={class:"item-info-centent"},P={class:"item-info"},Z=m((()=>(0,n._)("div",{class:"item-info-lable"},"门票数量：",-1))),B={class:"item-info-centent"},N={class:"item-info"},R=m((()=>(0,n._)("div",{class:"item-info-lable"},"门票时间：",-1))),Y={class:"item-info-centent"},I={class:"item-info"},O=m((()=>(0,n._)("div",{class:"item-info-lable"},"门票单价：",-1))),A={class:"item-info-centent"},J={class:"item-info"},K=m((()=>(0,n._)("div",{class:"item-info-lable"},"门票总价：",-1))),L={class:"item-info-centent"},E={class:"item-info"},G=m((()=>(0,n._)("div",{class:"item-info-lable"},"退款状态：",-1))),Q={class:"item-info-centent"},X={key:0,class:"item-info"},$=m((()=>(0,n._)("div",{class:"item-info-lable"},"退款时间：",-1))),ee={class:"item-info-centent"},te={key:1,class:"item-info-blcok"},ae={class:"item-info-blcok"},ne={key:0,style:{"margin-bottom":"10px"}},ie=m((()=>(0,n._)("span",null,"数量：",-1))),le={class:"dialog-footer"},oe={class:"dialog-footer"};var se={__name:"index",setup(e){const t=(0,d.oR)(),a=((0,i.iH)(0),(0,i.iH)(0),(0,i.iH)(t.state.UserInfo)),m=(0,i.iH)(!1),se=(0,i.iH)({}),ce=(0,i.iH)(!1),de=(0,i.qj)({number:0,stock:0,out_trade_no:null,refund_desc:null}),re=function(e){de.number=e},me=e=>{de.out_trade_no=null,de.refund_desc=null,de.stock=0,de.number=0,e?(de.stock=e.ticket_number,de.out_trade_no=e.out_trade_no):de.stock=0,ce.value=!0},ue=()=>{if(!de.refund_desc)return(0,r.z8)({message:"请填写备注信息",type:"warning"}),!1;if(null==de.out_trade_no){let e={out_trade_no:se.value.out_trade_no,refund_desc:de.refund_desc};t.dispatch("refundAll",e).then((e=>{0===e.code?((0,r.z8)({message:e.msg,type:"success"}),window.location.reload()):(0,r.z8)({message:e.msg,type:"warning"})}))}else{let e={out_trade_no:de.out_trade_no,ticket_number:de.number,refund_desc:de.refund_desc};if(!de.number)return(0,r.z8)({message:"请选择数量",type:"warning"}),!1;t.dispatch("refundOne",e).then((e=>{0===e.code?((0,r.z8)({message:e.msg,type:"success"}),window.location.reload()):(0,r.z8)({message:e.msg,type:"warning"})}))}return!1},_e=e=>{let n={bstr:a.value.businesstr,trade_no:e.row.trade_no};t.dispatch("orderDetail",n).then((e=>{se.value=e.data,m.value=!0}))},pe=(0,i.iH)([{label:"序号",type:"index",width:60},{label:"订单号",prop:"trade_no",width:240},{label:"金额",prop:"origin_price"},{label:"姓名",prop:"contact_man"},{label:"手机号",prop:"contact_phone"},{label:"订单状态",prop:"order_status_text"},{label:"退款状态",prop:"refund_status_text"},{label:"购买时间",prop:"create_time"},{label:"操作",fixed:"right",width:180,align:"center",tdSlot:"operate"}]),fe=async e=>{let n={contact_man:e.contact_man,contact_phone:e.contact_phone,order_status:e.order_status,create_time:e.create_time};n=JSON.stringify(n);let i={page:e.pageNum,limit:e.pageSize,bstr:a.value.businesstr,keyword:n},l={};return await t.dispatch("orderList",i).then((e=>{l={data:e.data.list,total:e.data.cnt}})),l};return(e,t)=>{const a=(0,n.up)("el-button"),d=(0,n.up)("el-config-provider"),r=(0,n.up)("el-input-number"),ve=(0,n.up)("el-input"),ge=(0,n.up)("el-dialog");return(0,n.wg)(),(0,n.iD)("div",u,[(0,n.Wm)(d,{locale:(0,i.SU)(c.Z)},{default:(0,n.w5)((()=>[(0,n.Wm)((0,i.SU)(s.Z),{columns:pe.value,request:fe,stripe:"",border:"",hideTitleBar:!0,search:{fields:[{type:"input",label:"联系人",name:"contact_man"},{type:"input",label:"手机号",name:"contact_phone"},{type:"select",label:"订单状态",name:"order_status",options:[{value:"created",name:"已创建未支付"},{value:"paid",name:"已支付"},{value:"paid",name:"已支付"},{value:"used",name:"已使用/核销"},{value:"cancelled",name:"已取消"},{value:"refunded",name:"已退款"}]},{type:"daterange",label:"日期",name:"create_time"}]}},{operate:(0,n.w5)((e=>[(0,n.Wm)(a,{size:"mini",type:"primary",onClick:(0,l.iM)((t=>_e(e)),["prevent"])},{default:(0,n.w5)((()=>[(0,n.Uk)("查看")])),_:2},1032,["onClick"])])),_:1},8,["columns"])])),_:1},8,["locale"]),(0,n.Wm)(ge,{modelValue:m.value,"onUpdate:modelValue":t[8]||(t[8]=e=>m.value=e),title:"订单详情","align-center":"","destroy-on-close":"","append-to-body":""},{default:(0,n.w5)((()=>[(0,n._)("div",_,[(0,n._)("div",p,[f,(0,n._)("div",v,(0,o.zw)(se.value.trade_no),1)]),(0,n._)("div",g,[w,(0,n._)("div",b,(0,o.zw)(se.value.amount_price),1)]),(0,n._)("div",h,[k,(0,n._)("div",y,(0,o.zw)(se.value.contact_man),1)]),(0,n._)("div",z,[x,(0,n._)("div",C,(0,o.zw)(se.value.contact_phone),1)]),(0,n._)("div",D,[U,(0,n._)("div",V,(0,o.zw)(se.value.create_time),1)]),(0,n._)("div",W,[T,(0,n._)("div",H,(0,o.zw)(se.value.order_status_text),1)])]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(se.value.detail,((e,t)=>((0,n.wg)(),(0,n.iD)("div",q,[(0,n._)("div",M,(0,o.zw)(e.ticket_title),1),(0,n._)("div",j,[F,(0,n._)("div",S,(0,o.zw)(e.ticket_title),1)]),(0,n._)("div",P,[Z,(0,n._)("div",B,(0,o.zw)(e.ticket_number),1)]),(0,n._)("div",N,[R,(0,n._)("div",Y,(0,o.zw)(e.ticket_date),1)]),(0,n._)("div",I,[O,(0,n._)("div",A,(0,o.zw)(e.ticket_price)+" 元",1)]),(0,n._)("div",J,[K,(0,n._)("div",L,(0,o.zw)(e.ticket_number*Number(e.ticket_price))+" 元",1)]),(0,n._)("div",E,[G,(0,n._)("div",Q,(0,o.zw)(e.refund_status_text),1)]),e.refund_time?((0,n.wg)(),(0,n.iD)("div",X,[$,(0,n._)("div",ee,(0,o.zw)(e.refund_time),1)])):(0,n.kq)("",!0),"fully_refunded"!==e.refund_status?((0,n.wg)(),(0,n.iD)("div",te,[(0,n.Wm)(a,{type:"danger",plain:"",onClick:t=>me(e)},{default:(0,n.w5)((()=>[(0,n.Uk)("立即退款")])),_:2},1032,["onClick"])])):(0,n.kq)("",!0)])))),256)),(0,n.Wm)(ge,{modelValue:ce.value,"onUpdate:modelValue":t[5]||(t[5]=e=>ce.value=e),width:"30%",title:"请填写退款信息","append-to-body":""},{footer:(0,n.w5)((()=>[(0,n._)("div",le,[(0,n.Wm)(a,{onClick:t[3]||(t[3]=e=>ce.value=!1)},{default:(0,n.w5)((()=>[(0,n.Uk)("关闭")])),_:1}),(0,n.Wm)(a,{type:"danger",onClick:t[4]||(t[4]=e=>ue())},{default:(0,n.w5)((()=>[(0,n.Uk)(" 确定提交 ")])),_:1})])])),default:(0,n.w5)((()=>[(0,n._)("div",ae,[0!==de.stock?((0,n.wg)(),(0,n.iD)("div",ne,[ie,(0,n.Wm)(r,{min:"0",modelValue:de.number,"onUpdate:modelValue":t[0]||(t[0]=e=>de.number=e),max:de.stock,style:{width:"100px"},onChange:t[1]||(t[1]=e=>re(e))},null,8,["modelValue","max"])])):(0,n.kq)("",!0),(0,n.Wm)(ve,{type:"textarea",modelValue:de.refund_desc,"onUpdate:modelValue":t[2]||(t[2]=e=>de.refund_desc=e),maxlength:"200","show-word-limit":"",placeholder:"请输入退款备注",autosize:{minRows:4,maxRows:10}},null,8,["modelValue"])])])),_:1},8,["modelValue"])])),footer:(0,n.w5)((()=>[(0,n._)("div",oe,[(0,n.Wm)(a,{onClick:t[6]||(t[6]=e=>m.value=!1)},{default:(0,n.w5)((()=>[(0,n.Uk)("关闭")])),_:1}),"fully_refunded"!==se.value.refund_status?((0,n.wg)(),(0,n.j4)(a,{key:0,type:"danger",onClick:t[7]||(t[7]=e=>me())},{default:(0,n.w5)((()=>[(0,n.Uk)(" 全部退款 ")])),_:1})):(0,n.kq)("",!0)])])),_:1},8,["modelValue"])])}}},ce=a(89);const de=(0,ce.Z)(se,[["__scopeId","data-v-18d453dc"]]);var re=de},814:function(e,t,a){a.d(t,{Z:function(){return n}});
/*! Element Plus v2.3.9 */
var n={name:"zh-cn",el:{colorpicker:{confirm:"确定",clear:"清空"},datepicker:{now:"此刻",today:"今天",cancel:"取消",clear:"清空",confirm:"确定",selectDate:"选择日期",selectTime:"选择时间",startDate:"开始日期",startTime:"开始时间",endDate:"结束日期",endTime:"结束时间",prevYear:"前一年",nextYear:"后一年",prevMonth:"上个月",nextMonth:"下个月",year:"年",month1:"1 月",month2:"2 月",month3:"3 月",month4:"4 月",month5:"5 月",month6:"6 月",month7:"7 月",month8:"8 月",month9:"9 月",month10:"10 月",month11:"11 月",month12:"12 月",weeks:{sun:"日",mon:"一",tue:"二",wed:"三",thu:"四",fri:"五",sat:"六"},months:{jan:"一月",feb:"二月",mar:"三月",apr:"四月",may:"五月",jun:"六月",jul:"七月",aug:"八月",sep:"九月",oct:"十月",nov:"十一月",dec:"十二月"}},select:{loading:"加载中",noMatch:"无匹配数据",noData:"无数据",placeholder:"请选择"},cascader:{noMatch:"无匹配数据",loading:"加载中",placeholder:"请选择",noData:"暂无数据"},pagination:{goto:"前往",pagesize:"条/页",total:"共 {total} 条",pageClassifier:"页",page:"页",prev:"上一页",next:"下一页",currentPage:"第 {pager} 页",prevPages:"向前 {pager} 页",nextPages:"向后 {pager} 页",deprecationWarning:"你使用了一些已被废弃的用法，请参考 el-pagination 的官方文档"},messagebox:{title:"提示",confirm:"确定",cancel:"取消",error:"输入的数据不合法!"},upload:{deleteTip:"按 delete 键可删除",delete:"删除",preview:"查看图片",continue:"继续上传"},table:{emptyText:"暂无数据",confirmFilter:"筛选",resetFilter:"重置",clearFilter:"全部",sumText:"合计"},tree:{emptyText:"暂无数据"},transfer:{noMatch:"无匹配数据",noData:"无数据",titles:["列表 1","列表 2"],filterPlaceholder:"请输入搜索内容",noCheckedFormat:"共 {total} 项",hasCheckedFormat:"已选 {checked}/{total} 项"},image:{error:"加载失败"},pageHeader:{title:"返回"},popconfirm:{confirmButtonText:"确定",cancelButtonText:"取消"}}}}}]);
//# sourceMappingURL=736.0c58ef9d.js.map